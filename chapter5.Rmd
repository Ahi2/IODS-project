---
title: "chapter5.Rmd"
author: "Ahi"
date: "2 joulukuuta 2017"
output: html_document
---

```{r}
library(GGally)
library(dplyr)
library(corrplot)
```

# 1. Loading data into R

In this exercise we use a real dataset developed by the UN to measure the humand development of countries in the world. 
We now explore the structure and the dimensions of the data.

```{r}
human2 <- read.table("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/human2.txt", sep  =",", header = T)

str(human2)
dim(human2)
summary(human2)
```

# 2. Graphical overview of the data and summary of the variables

Now we look at the normal disctributions, correlationshs, and a graphical overview.  
```{r}
ggpairs(human2)
```
As an example to explore the graph above, We can see that expected years of schooling (Edu.Exp) has almost a normal distrbution. We can also understand that there is quite a strong positive relationship between female/male ratio of secondary education (Edu2.Fm) and life expectancy at birth (Life.Exp).  

Let us also look at the correlations of the variables.
```{r}
cor(human2)
```

```{r}
cor(human2) %>% corrplot
```

As can be seen from the correlations, for instance, adolescent birth rate (Ado.Birth) and Maternal mortality ratio (Mar.Mor) have a strong positive corrleation, which is unsurprising. Less unsurpersing is the negative strong relationship between life expectancy at birth (Life.Exp) and Mat.Mor.

# 3. Principle Component Analysis on the not standardized variables

# 4. Principle Component Analysis on the standardized variables

In order to perform principle component analysis it is better to first standardize the variables. This is because PCS preassumes that variables with larger variance are more important than those with smaller.  
```{r}
human2_std <- scale(human2)

summary (human2_std)

```

Now let's perform PCA with the Singular Value Decomposition (SVD) method. 
```{r}
pca_human2 <- prcomp(human2_std)
```

Now, we draw a biplot of the principal component representation and the original variables.
```{r}
biplot(pca_human2, choices = 1:2, cex = c(0.8, 1), col = c("grey40", "deeppink2"))
```

