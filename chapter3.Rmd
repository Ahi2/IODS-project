---
title: "chapter3.Rmd"
author: "Ahi"
date: "19 marraskuuta 2017"
output: html_document
---

library(tidyr)
library(dplyr)
library(ggplot2)

# 2. Reading the joined dataset

```{r}
alc <- read.table("C:/Data/IODS-project/alc.csv", sep=",", header=TRUE)
```

This is a dataset which contains information on students achievment in two classes, math and Portuguese language. The aim is to see, e.g., how alocohol consumtpion and gender affect students' performance. The name of the variables used can be seen here:

```{r}
colnames(alc)
```

# 3. The hypotheses regarding four variables and alc consumption

Now we want to study the effect of students' gender, age, health, and final grade (G3) on students' alcohol consumption...we use high_consumption as the dependent variable...

# 4. exploring the distribution of the variables 
Let's look at the disribution of the variables selected:

```{r}
g1 <- ggplot(data = alc, aes(x = high_use)) + facet_wrap("sex")

g1 + geom_bar()

g2 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))

g2 + geom_boxplot() + ylab("grade")

g3 <- ggplot(alc, aes(x = high_use, y = health, col = sex)) + ggtitle("Student health by alcohol consumption and sex")

g3 + geom_boxplot() + ylab("health")

g4 <- ggplot(alc, aes(x = high_use, y = age)) + ggtitle("Student age by alcohol consumption")

g4 + geom_boxplot() + ylab("age")
```

# 5. Logistic regression

looking at the logistic model, where alcohol consumption is the depedent variables, which is binory (0 and 1), and gender, health, age, and grade are independent variables. 
```{r}
m <- glm(high_use ~ sex + G3 + health + age, data = alc, family = "binomial")
```

printing out the model:
```{r}
m
```

coefficients and the summary of the model

```{r}
coef(m)
summary(m)
```
Computing odds ratios (OR)

```{r}
OR <- coef(m) %>% exp
```

computing confidence intervals (CI)

```{r}
CI <- confint(m) %>% exp
```
Printing out the odds ratios with their confidence intervals
```{r}
cbind(OR, CI)
```
As can be seen from the results, the gender has the widest confidence interval. 


