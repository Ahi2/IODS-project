deep_columns <- select(lrn14, one_of(deep_questions))
lrn14$deep <- rowMeans(deep_columns)
surface_columns <- select(lrn14, one_of(surface_questions))
lrn14$surf <- rowMeans(surface_columns)
strategic_columns <- select(lrn14, one_of(strategic_questions))
lrn14$Stra <- rowMeans(strategic_columns)
deep_columns <- select (lrn14, one_of(deep_questions))
lrn14$deep <- rowMeans (deep_columns)
surface_columns <- select (lrn14, one_of(surface_questions))
lrn14$surf <- rowMeans (surface_columns)
strategic_columns <- select (lrn14, one_of(strategic_questions))
lrn14$Stra <- rowMeans (strategic_columns)
deep_columns <- select(lrn14, one_of(deep_questions))
lrn14$deep <- rowMeans(deep_columns)
surface_columns <- select(lrn14, one_of(surface_questions))
lrn14$surf <- rowMeans(surface_columns)
strategic_columns <- select(lrn14, one_of(strategic_questions))
lrn14$Stra <- rowMeans(strategic_columns)
deep_columns <- select(lrn14, one_of(deep_questions))
lrn14$deep <- rowMeans(deep_columns)
library(dplyr)
deep_questions <- c("D03", "D11", "D19", "D27", "D07", "D14", "D22", "D30","D06",  "D15", "D23", "D31")
surface_questions <- c("SU02","SU10","SU18","SU26", "SU05","SU13","SU21","SU29","SU08","SU16","SU24","SU32")
strategic_questions <- c("ST01","ST09","ST17","ST25","ST04","ST12","ST20","ST28")
deep_columns <- select(lrn14, one_of(deep_questions))
lrn14$deep <- rowMeans(deep_columns)
surface_columns <- select(lrn14, one_of(surface_questions))
lrn14$surf <- rowMeans(surface_columns)
strategic_columns <- select(lrn14, one_of(strategic_questions))
lrn14$Stra <- rowMeans(strategic_columns)
library(dplyr)
deep_questions <- c("D03", "D11", "D19", "D27", "D07", "D14", "D22", "D30","D06",  "D15", "D23", "D31")
surface_questions <- c("SU02","SU10","SU18","SU26", "SU05","SU13","SU21","SU29","SU08","SU16","SU24","SU32")
strategic_questions <- c("ST01","ST09","ST17","ST25","ST04","ST12","ST20","ST28")
deep_columns <- select(lrn14, one_of(deep_questions))
lrn14$deep <- rowMeans(deep_columns)
surface_columns <- select(lrn14, one_of(surface_questions))
lrn14$surf <- rowMeans(surface_columns)
strategic_columns <- select(lrn14, one_of(strategic_questions))
lrn14$Stra <- rowMeans(strategic_columns)
library(dplyr)
library(dplyr)
install.packages("dplyr")
library(dplyr)
deep_questions <- c("D03", "D11", "D19", "D27", "D07", "D14", "D22", "D30","D06",  "D15", "D23", "D31")
surface_questions <- c("SU02","SU10","SU18","SU26", "SU05","SU13","SU21","SU29","SU08","SU16","SU24","SU32")
strategic_questions <- c("ST01","ST09","ST17","ST25","ST04","ST12","ST20","ST28")
deep_columns <- select(lrn14, one_of(deep_questions))
lrn14$deep <- rowMeans(deep_columns)
surface_columns <- select(lrn14, one_of(surface_questions))
lrn14$surf <- rowMeans(surface_columns)
strategic_columns <- select(lrn14, one_of(strategic_questions))
lrn14$Stra <- rowMeans(strategic_columns)
lrn14 <- filter(lrn14, points > 0)
lrn14$Attitude
lrn14$Attitude <- lrn14$Attitude / 10
library(dplyr)
str(learning2014)
keep_columns <- c("gender", "Age", "attitude", "deep", "stra", "surf", "Points")
learning2014 <- select (lrn14, one_of(keep_columns))
str(learning2014)
keep_columns <- c("gender", "Age", "Attitude", "deep", "stra", "surf", "Points")
learning2014 <- select (lrn14, one_of(keep_columns))
str(learning2014)
library(dplyr)
deep_questions <- c("D03", "D11", "D19", "D27", "D07", "D14", "D22", "D30","D06",  "D15", "D23", "D31")
surface_questions <- c("SU02","SU10","SU18","SU26", "SU05","SU13","SU21","SU29","SU08","SU16","SU24","SU32")
strategic_questions <- c("ST01","ST09","ST17","ST25","ST04","ST12","ST20","ST28")
deep_columns <- select(lrn14, one_of(deep_questions))
lrn14$deep <- rowMeans(deep_columns)
surface_columns <- select(lrn14, one_of(surface_questions))
lrn14$surf <- rowMeans(surface_columns)
strategic_columns <- select(lrn14, one_of(strategic_questions))
lrn14$Stra <- rowMeans(strategic_columns)
lrn14$Attitude
lrn14$Attitude <- lrn14$Attitude / 10
library(dplyr)
keep_columns <- c("gender", "Age", "Attitude", "deep", "stra", "surf", "Points")
learning2014 <- select (lrn14, one_of(keep_columns))
str(learning2014)
library(dplyr)
deep_questions <- c("D03", "D11", "D19", "D27", "D07", "D14", "D22", "D30","D06",  "D15", "D23", "D31")
surface_questions <- c("SU02","SU10","SU18","SU26", "SU05","SU13","SU21","SU29","SU08","SU16","SU24","SU32")
strategic_questions <- c("ST01","ST09","ST17","ST25","ST04","ST12","ST20","ST28")
deep_columns <- select(lrn14, one_of(deep_questions))
lrn14$deep <- rowMeans(deep_columns)
surface_columns <- select(lrn14, one_of(surface_questions))
lrn14$surf <- rowMeans(surface_columns)
strategic_columns <- select(lrn14, one_of(strategic_questions))
lrn14$stra <- rowMeans(strategic_columns)
lrn14$Attitude
lrn14$Attitude <- lrn14$Attitude / 10
library(dplyr)
keep_columns <- c("gender", "Age", "Attitude", "deep", "stra", "surf", "Points")
learning2014 <- select (lrn14, one_of(keep_columns))
str(learning2014)
learning2014 <- filter(learning2014, Points > 0)
str(learning2014)
setwd("c:/Data/IODS-project")
?write.csv
write.csv(learning2014, file = "learning2014.csv")
write.csv(learning2014, file = "learning2014.csv")
read.csv ("c:/Data/IODS-project/learning2014")
read.csv ("c:/Data/IODS-project/learning2014.CSV")
str(learning2014)
head(learning2014)
dim(learning2014)
str(learning2014)
lrn14 <- read.table("C:\Data\learning2014.csv", sep="\t", header=TRUE)
lrn14 <- read.table("C:/Data/learning2014.csv", sep="\t", header=TRUE)
lrn14 <- read.table("C:/Data/IODS-project/learning2014.csv", sep="\t", header=TRUE)
dim(lrn14)
str(lrn14)
lrn14 <- read.table("C:/Data/IODS-project/learning2014.csv", header=TRUE)
dim(lrn14)
lrn14 <- read.table("C:/Data/IODS-project/learning2014.csv", header=TRUE)
dim(lrn14)
lrn14 <- read.table("C:/Data/IODS-project/learning2014.csv", sep="\t", header=TRUE)
dim(lrn14)
lrn14 <- read.table("C:/Data/IODS-project/learning2014.csv", sep="\t", header=TRUE)
dim(lrn14)
read.table("C:/Data/IODS-project/learning2014.csv", sep="\t", header=TRUE)
dim(learning2014)
str(learning2014)
library(ggplot2)
install.packages("ggplot2")
library(ggplot2)
pairs(learning2014)
pairs(learning2014[-1])
pairs(learning2014[-1], col = learning2014$gender)
install.packages("GGally")
library(GGally)
p <- ggpairs(learning2014)
p
p <- ggpairs(learning2014, mapping = aes(col = gender, alpha = 0.3), lower = list(combo = wrap ("facethist", bins = 20)))
p
summary(p)
qplot(Attitude, Points, data = learning2014) + geom_smooth(method = "lm")
my_model <- lm(Points ~ Attitude, data = learning2014)
summary(my_model)
my_model2 <- lm(points ~ attitude + stra + surf, data = learning2014)
my_model2 <- lm(Points ~ Attitude + stra + surf, data = learning2014)
summary(my_model2)
my_model2 <- lm(Points ~ Attitude + stra, data = learning2014)
my_model3 <- lm(Points ~ Attitude + stra, data = learning2014)
summary(my_model3)
plot(my_model3, which = c(1,2,5))
par(mfrow = c(2,2))
plot(my_model3, which = c(1,2,5))
dim(learning2014)
str(learning2014)
read.table("C:/Data/IODS-project/learning2014.csv", sep="\t", header=TRUE)
dim(learning2014)
learning2014 <- read.table("C:/Data/IODS-project/learning2014.csv", sep="\t", header=TRUE)
dim(learning2014)
learning2014 <- read.table("C:/Data/IODS-project/learning2014.csv", sep="\t", header=TRUE)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
alc <- read.table("C:/Data/IODS-project/alc.csv", sep=",", header=TRUE)
colnames(alc)
g1 <- ggplot(data = alc, aes(x = high_use)) + facet_wrap("sex")
loss_func(class = alc$high_use, prob = alc$probability)
g1 <- ggplot2(data = alc, aes(x = high_use)) + facet_wrap("sex")
g1 <- ggplot(data = alc, aes(x = high_use)) + facet_wrap("sex")
g1 <- ggplot(data = alc, aes(x = alc_use)) + facet_wrap("sex")
g1 + geom_bar()
g1 <- ggplot(data = alc, aes(x = alc_use)) + facet_wrap("sex")
library(tidyr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(dplyr)
g1 <- ggplot(data = alc, aes(x = alc_use)) + facet_wrap("sex")
g1 + geom_bar()
g1 + geom_bar()
g1 <- ggplot(data = alc, aes(x = high_use)) + facet_wrap("sex")
g1 + geom_bar()
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
alc <- read.table("C:/Data/IODS-project/alc.csv", sep=",", header=TRUE)
colnames(alc)
g1 <- ggplot(data = alc, aes(x = high_use)) + facet_wrap("sex")
g1 + geom_bar()
g2 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
g2 + geom_boxplot() + ylab("grade")
g3 <- ggplot(alc, aes(x = high_use, y = health, col = sex)) + ggtitle("Student health by alcohol consumption and sex")
g3 + geom_boxplot() + ylab("health")
g4 <- ggplot(alc, aes(x = high_use, y = age)) + ggtitle("Student age by alcohol consumption")
g4 + geom_boxplot() + ylab("age")
m <- glm(high_use ~ sex + G3 + health + age, data = alc, family = "binomial")
m
coef(m)
summary(m)
OR <- coef(m) %>% exp
CI <- confint(m) %>% exp
cbind(OR, CI)
m2 <- glm(high_use ~ sex + G3 + age, data = alc, family = "binomial")
probabilities <- predict(m, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probability > 0.5)
select(alc, sex, G3, age, high_use, probability, prediction) %>% tail(10)
table(high_use = alc$high_use, prediction = alc$prediction)
g <- ggplot(alc, aes(x = probability, y = high_use, col = prediction))
g + geom_point()
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
alc <- read.table("C:/Data/IODS-project/alc.csv", sep=",", header=TRUE)
colnames(alc)
g1 <- ggplot(data = alc, aes(x = high_use)) + facet_wrap("sex")
g1 + geom_bar()
g2 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
g2 + geom_boxplot() + ylab("grade")
g3 <- ggplot(alc, aes(x = high_use, y = health, col = sex)) + ggtitle("Student health by alcohol consumption and sex")
g3 + geom_boxplot() + ylab("health")
g4 <- ggplot(alc, aes(x = high_use, y = age)) + ggtitle("Student age by alcohol consumption")
g4 + geom_boxplot() + ylab("age")
m <- glm(high_use ~ sex + G3 + health + age, data = alc, family = "binomial")
m
coef(m)
summary(m)
OR <- coef(m) %>% exp
CI <- confint(m) %>% exp
cbind(OR, CI)
m2 <- glm(high_use ~ sex + G3 + age, data = alc, family = "binomial")
probabilities <- predict(m, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probability > 0.5)
select(alc, sex, G3, age, high_use, probability, prediction) %>% tail(10)
table(high_use = alc$high_use, prediction = alc$prediction)
g <- ggplot(alc, aes(x = probability, y = high_use, col = prediction))
g + geom_point()
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m, K = 10)
cv$delta[1]
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m2, K = 10)
cv$delta[1]
m3 <- glm(high_use ~ sex + G3, data = alc, family = "binomial")
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m3, K = 10)
cv$delta[1]
m4 <- glm(high_use ~ sex + absences, data = alc, family = "binomial")
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m4, K = 10)
cv$delta[1]
m5 <- glm(high_use ~ absences, data = alc, family = "binomial")
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m5, K = 10)
cv$delta[1]
m5 <- glm(high_use ~ sex, data = alc, family = "binomial")
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m5, K = 10)
cv$delta[1]
alc <- read.table("C:/Data/IODS-project/alc.csv", sep=",", header=TRUE)
colnames(alc)
g1 <- ggplot(data = alc, aes(x = high_use)) + facet_wrap("sex")
library(tidyr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(dplyr)
library(ggplot2)
alc <- read.table("C:/Data/IODS-project/alc.csv", sep=",", header=TRUE)
colnames(alc)
g1 <- ggplot(data = alc, aes(x = high_use)) + facet_wrap("sex")
g1 + geom_bar()
g2 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
g2 + geom_boxplot() + ylab("grade")
g3 <- ggplot(alc, aes(x = high_use, y = health, col = sex)) + ggtitle("Student health by alcohol consumption and sex")
g3 + geom_boxplot() + ylab("health")
g4 <- ggplot(alc, aes(x = high_use, y = age)) + ggtitle("Student age by alcohol consumption")
g4 + geom_boxplot() + ylab("age")
m <- glm(high_use ~ sex + G3 + health + age, data = alc, family = "binomial")
m
coef(m)
summary(m)
OR <- coef(m) %>% exp
CI <- confint(m) %>% exp
cbind(OR, CI)
m2 <- glm(high_use ~ sex + G3 + age, data = alc, family = "binomial")
probabilities <- predict(m, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probability > 0.5)
select(alc, sex, G3, age, high_use, probability, prediction) %>% tail(10)
table(high_use = alc$high_use, prediction = alc$prediction)
g <- ggplot(alc, aes(x = probability, y = high_use, col = prediction))
g + geom_point()
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m, K = 10)
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m, K = 10)
cv$delta[1]
m5 <- glm(high_use ~ sex + age + studytime + failures + famsup + goout + famre + health + absences, data = alc, family = "binomial")
m5 <- glm(high_use ~ sex + age + studytime + failures + famsup + goout + famrel + health + absences, data = alc, family = "binomial")
summary(m5)
coef(m5)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m4, K = 10)
cv$delta[1]
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m5, K = 10)
cv$delta[1]
m6 <- glm(high_use ~ sex + studytime + goout + famrel + absences, data = alc, family = "binomial")
summary(m6)
coef(m6)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m6, K = 10)
cv$delta[1]
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
g5 -> ggplot(alc, aes(x = high_use, y = studytime, col = sex)) + ggtitle("Student study time and by alcohol consumption and sex")
g5 <- ggplot(alc, aes(x = high_use, y = studytime, col = sex)) + ggtitle("Student study time and by alcohol consumption and sex")
g5 + geom_boxplot() + ylab("study time")
g6 <- ggplot(alc, aes(x = high_use, y = famrel, col = sex))
g6 + geom_boxplot() + ylab("family relationship")
library(tidyr)
library(dplyr)
library(ggplot2)
library(ggplot2)
alc <- read.table("C:/Data/IODS-project/alc.csv", sep=",", header=TRUE)
colnames(alc)
g1 <- ggplot(data = alc, aes(x = high_use)) + facet_wrap("sex")
g1 + geom_bar()
g2 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
g2 + geom_boxplot() + ylab("grade")
g3 <- ggplot(alc, aes(x = high_use, y = health, col = sex)) + ggtitle("Student health by alcohol consumption and sex")
g3 + geom_boxplot() + ylab("health")
g4 <- ggplot(alc, aes(x = high_use, y = age)) + ggtitle("Student age by alcohol consumption")
g4 + geom_boxplot() + ylab("age")
m <- glm(high_use ~ sex + G3 + health + age, data = alc, family = "binomial")
m
coef(m)
summary(m)
OR <- coef(m) %>% exp
CI <- confint(m) %>% exp
cbind(OR, CI)
m2 <- glm(high_use ~ sex + G3 + age, data = alc, family = "binomial")
probabilities <- predict(m, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probability > 0.5)
select(alc, sex, G3, age, high_use, probability, prediction) %>% tail(10)
table(high_use = alc$high_use, prediction = alc$prediction)
g <- ggplot(alc, aes(x = probability, y = high_use, col = prediction))
g + geom_point()
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m, K = 10)
cv$delta[1]
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m2, K = 10)
cv$delta[1]
m3 <- glm(high_use ~ sex + G3, data = alc, family = "binomial")
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m3, K = 10)
cv$delta[1]
m4 <- glm(high_use ~ sex + absences, data = alc, family = "binomial")
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m4, K = 10)
cv$delta[1]
m5 <- glm(high_use ~ sex + age + studytime + failures + famsup + goout + famrel + health + absences, data = alc, family = "binomial")
summary(m5)
coef(m5)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m5, K = 10)
cv$delta[1]
g5 <- ggplot(alc, aes(x = high_use, y = studytime, col = sex)) + ggtitle("Student study time and by alcohol consumption and sex")
g5 + geom_boxplot() + ylab("study time")
g6 <- ggplot(alc, aes(x = high_use, y = famrel, col = sex))
g6 + geom_boxplot() + ylab("family relationship")
m6 <- glm(high_use ~ sex + studytime + goout + famrel + absences, data = alc, family = "binomial")
summary(m6)
coef(m6)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m6, K = 10)
cv$delta[1]
g1 <- ggplot(data = alc, aes(x = high_use)) + facet_wrap("sex")
g1 + geom_bar()
alc <- read.table("C:/Data/IODS-project/alc.csv", sep=",", header=TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
g1 <- ggplot(data = alc, aes(x = high_use)) + facet_wrap("sex")
g1 <- ggplot(alc, aes(x = high_use)) + facet_wrap("sex")
g1 <- ggplot(alc, aes(x = high_use)) + facet_wrap("sex")
g1 + geom_bar()
g1 <- ggplot(alc, aes(x = high_use)) + facet_wrap("sex")
g1 + geom_bar()
g1 <- ggplot(alc, aes(x = high_use)) + facet_wrap("sex")
g1 + geom_bar()
library(tidyr)
library(dplyr)
library(ggplot2)
alc <- read.table("C:/Data/IODS-project/alc.csv", sep=",", header=TRUE)
colnames(alc)
g1 <- ggplot(alc, aes(x = high_use)) + facet_wrap("sex")
g1 + geom_bar()
g2 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
g2 + geom_boxplot() + ylab("grade")
g3 <- ggplot(alc, aes(x = high_use, y = health, col = sex)) + ggtitle("Student health by alcohol consumption and sex")
g3 + geom_boxplot() + ylab("health")
g4 <- ggplot(alc, aes(x = high_use, y = age)) + ggtitle("Student age by alcohol consumption")
g4 + geom_boxplot() + ylab("age")
```{r child = "chapter3.Rmd"}
library(ggplot2)
OR <- coef(m) %>% exp
cbind(OR, CI)
library(tidyr)
library(dplyr)
library(ggplot2)
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
g1 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
g1 + geom_bar() + ylab("grade")
g1 <- ggplot(alc, aes(x = high_use, y = G3, col = sex))
g1 + geom_boxplot() + ylab("grade")
g2 <- ggplot(alc, aes(x = high_use, y = health, col = sex)) + ggtitle("Student health by alcohol consumption and sex")
g2 + geom_boxplot() + ylab("health")
g3 <- ggplot(alc, aes(x = high_use, y = age)) + ggtitle("Student age by alcohol consumption")
g3 + geom_boxplot() + ylab("age")
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
m <- glm(high_use ~ sex + G3 + health + age, data = alc, family = "binomial")
m
coef(m)
summary(m)
OR <- coef(m) %>% exp
CI <- confint(m) %>% exp
cbind(OR, CI)
m2 <- glm(high_use ~ sex + G3 + age, data = alc, family = "binomial")
probabilities <- predict(m, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probability > 0.5)
select(alc, sex, G3, age, high_use, probability, prediction) %>% tail(10)
table(high_use = alc$high_use, prediction = alc$prediction)
g <- ggplot(alc, aes(x = probability, y = high_use, col = prediction))
g + geom_point()
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
probabilities <- predict(m2, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probability > 0.5)
select(alc, sex, G3, age, high_use, probability, prediction) %>% tail(10)
table(high_use = alc$high_use, prediction = alc$prediction)
g <- ggplot(alc, aes(x = probability, y = high_use, col = prediction))
g + geom_point()
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = alc$probability)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m, K = 10)
cv$delta[1]
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m2, K = 10)
cv$delta[1]
m3 <- glm(high_use ~ sex + G3, data = alc, family = "binomial")
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m3, K = 10)
cv$delta[1]
m4 <- glm(high_use ~ sex + absences, data = alc, family = "binomial")
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m4, K = 10)
cv$delta[1]
m5 <- glm(high_use ~ sex + age + studytime + failures + famsup + goout + famrel + health + absences, data = alc, family = "binomial")
summary(m5)
coef(m5)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m5, K = 10)
cv$delta[1]
g5 <- ggplot(alc, aes(x = high_use, y = studytime, col = sex)) + ggtitle("Student study time and by alcohol consumption and sex")
g5 + geom_boxplot() + ylab("study time")
g6 <- ggplot(alc, aes(x = high_use, y = famrel, col = sex))
g6 + geom_boxplot() + ylab("family relationship")
m6 <- glm(high_use ~ sex + studytime + goout + famrel + absences, data = alc, family = "binomial")
summary(m6)
coef(m6)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m6, K = 10)
cv$delta[1]
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
```{r child = "chapter3.Rmd"}
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
library(dplyr); library(ggplot2)
alc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))
library(tidyr); library(dplyr); library(ggplot2)
